
function BusIcon(app) {
    app.get("/api/busicon/:busId/:routeNo/:direction/:color", (req, res) => {
        const color = req.params["color"];
        const busId = req.params["busId"];
        const routeNo = req.params["routeNo"];
        const direction = req.params["direction"];
        if (color.endsWith(".svg")) {
            // let svg = `
            // <svg id="svgContent" version="1.1" width="48" height="48" style="width: 48px; height: 48px; margin:auto; user-select: none; cursor: default;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48"><g id="svgPath"><path d="M 16 21.500 L 16 26 24 26 L 32 26 32 21.500 L 32 17 24 17 L 16 17 16 21.500 M 15.110 32.367 C 14.246 33.409, 14.346 34.042, 15.530 35.025 C 17.441 36.611, 19.574 34.939, 18.664 32.567 C 17.923 30.637, 16.608 30.563, 15.110 32.367 M 29.336 32.567 C 28.426 34.939, 30.559 36.611, 32.470 35.025 C 33.654 34.042, 33.754 33.409, 32.890 32.367 C 31.392 30.563, 30.077 30.637, 29.336 32.567" stroke="none" fill="#222222" fill-rule="evenodd"></path><path d="M 12 25.500 C 12 33.833, 12.383 39, 13 39 C 13.550 39, 14 40.125, 14 41.500 C 14 43.611, 14.467 44, 17 44 C 19.533 44, 20 43.611, 20 41.500 C 20 39.250, 20.400 39, 24 39 C 27.600 39, 28 39.250, 28 41.500 C 28 43.611, 28.467 44, 31 44 C 33.533 44, 34 43.611, 34 41.500 C 34 40.125, 34.450 39, 35 39 C 35.617 39, 36 33.833, 36 25.500 L 36 12 24 12 L 12 12 12 25.500 M 16 21.500 L 16 26 24 26 L 32 26 32 21.500 L 32 17 24 17 L 16 17 16 21.500 M 15.110 32.367 C 14.246 33.409, 14.346 34.042, 15.530 35.025 C 17.441 36.611, 19.574 34.939, 18.664 32.567 C 17.923 30.637, 16.608 30.563, 15.110 32.367 M 29.336 32.567 C 28.426 34.939, 30.559 36.611, 32.470 35.025 C 33.654 34.042, 33.754 33.409, 32.890 32.367 C 31.392 30.563, 30.077 30.637, 29.336 32.567" stroke="none" fill="#${color.replace(".svg", "")}" fill-rule="evenodd"></path></g></svg>
            // `;
            let svg = `
            <svg id="svgContent" version="1.1" width="512" height="512" style="position: relative; width: 512px; height: 512px; margin:auto; user-select: none; cursor: default;"
            xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 560">
                <g id="svgPath">
                    <path d="M 128 181.500 L 128 235 256 235 L 384 235 384 181.500 L 384 128 256 128 L 128 128 128 181.500 M 148.006 301.153 C 140.657 304.054,132.891 312.002, 130.089 319.491 C 123.486 337.141, 133.386 356.277, 151.905 361.661 C 162.554 364.757, 175.053 361.138, 183.409 352.540 C 197.819 337.714, 193.296 311.843, 174.623 302.282 C 167.391 298.579, 155.777 298.086, 148.006 301.153 M 340.006 301.153 C 332.657 304.054, 324.891 312.002, 322.089 319.491 C 315.486 337.141, 325.386 356.277, 343.905 361.661 C 354.554 364.757, 367.053 361.138, 375.409 352.540 C 389.819 337.714, 385.296 311.843, 366.623 302.282 C 359.391 298.579, 347.777 298.086, 340.006 301.153" stroke="none" fill="#ffffff" fill-rule="evenodd">
                    </path>
                    <path d="M 225.500 43.045 C 182.991 44.547, 155.962 48.945, 133.176 58.067 C 114.428 65.572, 100.185 77.700, 93.070 92.217 C 84.962 108.760, 85.500 98.678, 85.500 234 L 85.500 354.500 88.329 361.840 C 92.069 371.545, 96.212 378.506, 101.516 384 L 105.861 388.500 106.190 410.500 C 106.494 430.889, 106.679 432.802, 108.715 436.624 C 111.431 441.722, 115.924 445.599, 120.795 447.050 C 123.068 447.727, 130.912 448.027, 141.090 447.827 C 157.480 447.504, 157.729 447.466, 161.807 444.637 C 164.382 442.851, 166.886 439.862, 168.467 436.691 C 170.781 432.047, 171 430.501, 171 418.804 L 171 406 256 406 L 341 406 341.022 418.750 C 341.039 428.914, 341.413 432.313, 342.865 435.509 C 344.820 439.812, 350.682 445.548, 354.676 447.067 C 356.026 447.580, 364.544 448, 373.605 448 C 391.703 448, 394.555 447.285, 400.211 441.327 C 405.195 436.078, 406 431.700, 406 409.848 L 406 389.947 411.567 383.223 C 414.629 379.526, 418.662 373.338, 420.530 369.472 C 427.373 355.311, 427.080 361.861, 426.743 230.242 C 426.402 97.535, 426.968 107.888, 419.191 92 C 414.253 81.912, 402.696 70.312, 391.128 63.834 C 376.932 55.884, 353.288 49.062, 329.500 46.054 C 306.764 43.179, 260.004 41.826, 225.500 43.045 M 128 181.500 L 128 235 256 235 L 384 235 384 181.500 L 384 128 256 128 L 128 128 128 181.500 M 148.006 301.153 C 140.657 304.054, 132.891 312.002, 130.089 319.491 C 123.486 337.141, 133.386 356.277, 151.905 361.661 C 162.554 364.757, 175.053 361.138, 183.409 352.540 C 197.819 337.714, 193.296 311.843, 174.623 302.282 C 167.391 298.579, 155.777 298.086, 148.006 301.153 M 340.006 301.153 C 332.657 304.054, 324.891 312.002, 322.089 319.491 C 315.486 337.141, 325.386 356.277, 343.905 361.661 C 354.554 364.757, 367.053 361.138, 375.409 352.540 C 389.819 337.714, 385.296 311.843, 366.623 302.282 C 359.391 298.579, 347.777 298.086, 340.006 301.153" stroke="none" fill="#ff0000" fill-rule="evenodd">
                    </path>
                    <text x="50%" y="225" style="font-size: 120px; text-anchor: middle; font-family: monospace; font-weight: bold;" fill="black">${routeNo}</text>
                    <text x="50%" y="530" style="font-size: 120px; text-anchor: middle; font-family: monospace; font-weight: bold; filter: drop-shadow(0px 0px 4px rgb(0 0 0 / 1));" fill="white">${busId}-${direction[0]}</text>
                </g>
            </svg>
            `
            res.setHeader("Content-Type", "image/svg+xml");
            res.status(200).send(svg);
        } else {
            res.status(404);
        }
    });
}

module.exports = { BusIcon };